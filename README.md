# Distributed Systems Project 2015-2016 #

Group 64 - Campus Alameda

André Águas - 78854 - andre.aguas@ist.utl.pt

Rui Sá - 78324 - rui.sa@ist.utl.pt

João Neto - 78745 - joao.b.neto@ist.utl.pt


Repository:
[tecnico-distsys/A_64-project](https://github.com/tecnico-distsys/A_64-project/)

-------------------------------------------------------------------------------
## Description

Development of a sistemy basead in Web Services, implemented in the J2EE plarform, to aggregate services of good transporters, similar to Uber's service with passengers.

The systems is composed by clients, a broker, transporters and a name server (UDDI). The transporters publish themselves in the name server and the broker user this server to find them and negotiate the services requested by the clients.
Here is a simple figure of the system's architecture: 

<img src="https://github.com/abaguas/UpaTransporter/blob/master/images/architecture.png" width ="800" height="400">


In addition, the system is composed by other components that guarantee reliability and secuirity. The broker has a primary backup to prevent its failure. The authenticity, fresheness and integrity of the communication between the broker and the transporters are guaranteed using digital signatures. The keys used in this signatures are generated by a CA that was also implemented as part of the project.


The client only communicates with the broker to request services. Then, the broker negotiates with the transporters to try to find the lowest price for the tranport. During this negotiation there are the following states:


<img src="https://github.com/abaguas/UpaTransporter/blob/master/images/states.png" width ="600" height="600"> 

## Dependencies

Refer to Software_dependencies.md

## Installation Instructions


### Environment

[0] Boot the OS

Linux or Mac OS X


[1] Initiate the support servers

JUDDI:
```
./juddi-3.3.2_tomcat-7.0.64_9090/bin/startup.sh
```


[2] Create temporary folder

```
cd ...
mkdir ...
```


[3] Obtain source code of the project

```
git clone https://github.com/abaguas/UpaTransporter.git (via https) 
git clone git@github.com:abaguas/UpaTransporter.git (via ssh)
```



[4] Install auxiliary libraries and modules

```
cd uddi-naming
mvn clean install
```

```
cd ...
mvn clean install
```

-------------------------------------------------------------------------------

### Serviço CA

[1] Construir e executar **servidor**

```
cd ...-ws
mvn clean install
mvn exec:java
```

[2] Construir **cliente** e executar testes

```
cd ...-ws-cli
mvn clean install
```

...


-------------------------------------------------------------------------------


-------------------------------------------------------------------------------

### Serviço TRANSPORTER

[1] Construir e executar **servidor**

```
cd ...-ws
mvn clean install
mvn exec:java
```

[2] Construir **cliente** e executar testes

```
cd ...-ws-cli
mvn clean install
```

...


-------------------------------------------------------------------------------

### Serviço BROKER

[1] Construir e executar **servidor**

```
cd ...-ws
mvn clean install
mvn exec:java
```


[2] Construir **cliente** e executar testes

```
cd ...-ws-cli
mvn clean install
```

...

-------------------------------------------------------------------------------
Instrucoes para o projeto:

Nas transportadoras existe uma opção -Dws.i que define qual o seu número.
Foram distribuidos certificados para transportadoras até ao número 5.

Nos brokers existe a opçao -Dws.br que define tambem o numero do broker. A falta de argumentos ou o numero 1 dá o nome ao broker principal: 'UpaBroker'. Qualquer outro número define um broker backup de nome 'UpaBrokerN'
Também existe a opção -Dws.nap que define um tempo de espera no broker, para que tarde a resposta ao cliente.
Para iniciar os brokers as tranportadoras e o CA devem estar publicados. A ordem de publicacao dos brokers é indiferente. Mas depois é necessário fazer um 'enter' no principal depois de o backup estar ativo, e depois enter no backup para que ele inicie o timer que verifica se houve ou não falha no Broker principal


Nos clientes do broker foi adicionada a opcão -Dprocess que envia um sigKill ao processo do broker. Esta opçao serve para os testes de IT a apresentar na demonstração.

-------------------------------------------------------------------------------
**FIM**
